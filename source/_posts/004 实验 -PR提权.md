004 实验 -PR提权

## Contents

- [Contents]()
- [实验]()
- [过程]()

## 实验

![](/resources/80fb0dad8a4b01a096584074e0ebbd69.png)

## 过程

1. 首先通过菜刀连接上

![](/resources/f4504305ca3d51477950ed7d10130c58.png)

2. 访问虚拟终端，查看一下权限
![](/resources/8284934a8be272725dd9f95676288c72.png)
![](/resources/8b909cd553be871e2df6fd8eab67b3e4.png)
发现拒绝访问，有可能是因为做了限制，是这里无法访问到cmd.exe
所以我们手动上传一个cmd.exe
![](/resources/29c3133ab012e7e9036f91ec1b7c5c26.png)
访问这个cmd.exe
![](/resources/401c4774741aadf0bba8bd0112366b6f.png)
![](/resources/6be7978b8e14280dc162b890b8f3a9d3.png)
权限是service，权限不高
3. 要进行提权
首先查看systeminfo，看看什么系统，打了什么补丁
![](/resources/521585d7262799bceff230a3b89a6f7e.png)
![](/resources/e54c802f97f74a0135cc1a785b48ad8d.png)
4. 找一下什么提权漏洞可以利用
![](/resources/854a2a94d93212403c98b1bf72d818ee.png)
![](/resources/fedd6933da4cba365e4d2e02d47367a6.png)
![](/resources/796e3cd9f5d9c5225a7a259fbb78401d.png)
发现可以用pr提权
5. 上传pr提权工具
![](/resources/ed8c0437822f373760e7813a82e6475d.png)
6. 查看pr工具的使用
![](/resources/281da3b37dac5696a3a6addd0b585289.png)
进行提权 (不知道为什么第一次会超时)
![](/resources/03c1f2fbc40ef4b89791120ae16dcff1.png)
这个时候的用户权限提高了
7. 利用pr程序添加管理员权限的用户
添加用户
![](/resources/40bab25c5ea54e888799b78043d92531.png)
加入到管理员
![](/resources/6391d6839065f10b55c52f02fb71d8dd.png)
8. 查看3389远程连接端口是否开放
![](/resources/8fa296fd320d554b7879c5b3ba7495b0.png)
发现3389端口未开放，打开3389
传入打开3389的脚本
![](/resources/041a54ec0fef37b54a74a4114d4e88c1.png)
运行它
![](/resources/ae4aa5e5cf46f9c10a1560b661be68f9.png)
查看3389端口已经打开
![](/resources/caacbf98e9cc73446bba5663168ccdf7.png)
9. 远程登录
![](/resources/3427ba43569bb29fe30980ecbcc697da.png)
![](/resources/d7b5e93612b45d99259cfa2a8e1b275e.png)
成功登录
![](/resources/5a845cba82c3eeb6b8dbacb380480a3c.png)
10. 这里面有个IIS6
有个IIS6的